{++m;tree_increment("edge", $1, $2, 1)}END{while (tree_iters_remaining("edge") > 0){u = tree_next("edge"); while (tree_iters_remaining("edge", u) > 0){v = tree_next("edge", u); {if(u""==v""){++self;print(u,": ",v);continue;}if((tree_elem_exists("edge", v)) && (tree_elem_exists("edge", v, u)))++both } } };printf "%d directed edges, %d self-loops, %d both directions\n", m, self, both/2}